// Backbone.Syphon, v0.5.0
// Copyright (c) 2014 Derick Bailey, Muted Solutions, LLC.
// Distributed under MIT license
// http://github.com/marionettejs/backbone.syphon

!function(a,b){if("function"==typeof define&&define.amd)define(["underscore","backbone","jquery"],function(a,c,d){return b(a,c,d)});else if("undefined"!=typeof exports){var c=require("underscore"),d=require("backbone"),e=require("jquery");module.exports=b(c,d,e)}else b(a._,a.Backbone,a.jQuery)}(this,function(a,b,c){"use strict";var d=b.Syphon,e=b.Syphon={};e.VERSION="0.5.0",e.noConflict=function(){return b.Syphon=d,this},e.ignoredTypes=["button","submit","reset","fieldset"],e.serialize=function(b,d){var e={},f=j(d),i=g(b,f);return a.each(i,function(a){var b=c(a),d=h(b),g=f.keyExtractors.get(d),i=g(b),j=f.inputReaders.get(d),l=j(b),m=f.keyAssignmentValidators.get(d);if(m(b,i,l)){var n=f.keySplitter(i);e=k(e,n,l)}}),e},e.deserialize=function(b,d,e){var f=j(e),i=g(b,f),k=l(f,d);a.each(i,function(a){var b=c(a),d=h(b),e=f.keyExtractors.get(d),g=e(b),i=f.inputWriters.get(d),j=k[g];i(b,j)})};var f=function(b,c){var d=c.keySplitter(b)||[],e=a.map(d,function(a,b){return d.slice(0,b+1).reduce(c.keyJoiner)});return e},g=function(b,d){var e=i(b),g=e.elements;return g=a.reject(g,function(b){var e=h(b),g=d.keyExtractors.get(e),i=g(c(b)),j=f(i,d),k=a.include(d.ignoredTypes,e),l=0!==a.intersection(d.include,j).length,m=0!==a.intersection(d.exclude,j).length;return l?!1:d.include?!0:m||k})},h=function(a){var b,d=c(a),e=d[0].tagName,f=e;return"input"===e.toLowerCase()&&(b=d.attr("type"),f=b?b:"text"),f.toLowerCase()},i=function(b){return a.isUndefined(b.$el)&&"form"===b.tagName.toLowerCase()?b:b.$el.is("form")?b.el:b.$("form")[0]},j=function(b){var c=a.clone(b)||{};return c.ignoredTypes=a.clone(e.ignoredTypes),c.inputReaders=c.inputReaders||e.InputReaders,c.inputWriters=c.inputWriters||e.InputWriters,c.keyExtractors=c.keyExtractors||e.KeyExtractors,c.keySplitter=c.keySplitter||e.KeySplitter,c.keyJoiner=c.keyJoiner||e.KeyJoiner,c.keyAssignmentValidators=c.keyAssignmentValidators||e.KeyAssignmentValidators,c},k=function(b,c,d){if(!c)return b;var e=c.shift();return b[e]||(b[e]=a.isArray(e)?[]:{}),0===c.length&&(a.isArray(b[e])?b[e].push(d):b[e]=d),c.length>0&&k(b[e],c,d),b},l=function(b,c,d){var e={};return a.each(c,function(c,f){var g={};d&&(f=b.keyJoiner(d,f)),a.isArray(c)?(f+="[]",g[f]=c):a.isObject(c)?g=l(b,c,f):g[f]=c,a.extend(e,g)}),e},m=e.TypeRegistry=function(){this.registeredTypes={}};m.extend=b.Model.extend,a.extend(m.prototype,{get:function(a){return this.registeredTypes[a]||this.registeredTypes["default"]},register:function(a,b){this.registeredTypes[a]=b},registerDefault:function(a){this.registeredTypes["default"]=a},unregister:function(a){this.registeredTypes[a]&&delete this.registeredTypes[a]}});var n=e.KeyExtractorSet=m.extend(),o=e.KeyExtractors=new n;o.registerDefault(function(a){return a.prop("name")||""});var p=e.InputReaderSet=m.extend(),q=e.InputReaders=new p;q.registerDefault(function(a){return a.val()}),q.register("checkbox",function(a){return a.prop("checked")});var r=e.InputWriterSet=m.extend(),s=e.InputWriters=new r;s.registerDefault(function(a,b){a.val(b)}),s.register("checkbox",function(a,b){a.prop("checked",b)}),s.register("radio",function(a,b){a.prop("checked",a.val()===b.toString())});var t=e.KeyAssignmentValidatorSet=m.extend(),u=e.KeyAssignmentValidators=new t;return u.registerDefault(function(){return!0}),u.register("radio",function(a){return a.prop("checked")}),e.KeySplitter=function(a){var b,c=a.match(/[^\[\]]+/g);return a.indexOf("[]")===a.length-2&&a.length>1&&(b=c.pop(),c.push([b])),c},e.KeyJoiner=function(a,b){return a+"["+b+"]"},b.Syphon});
//# sourceMappingURL=backbone.syphon.min.map